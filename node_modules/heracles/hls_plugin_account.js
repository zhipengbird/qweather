
import { callNative } from './hls_plugin_base.js'
import { saveLoginUserInfo, saveLoginUserToken, removeLoginUserToken, getLoginUserToken } from './hls_app_env_storage.js'
import APP_EVENT from './hls_app_event.js'

const ACCOUNT_MODULE = "account"

/**
 * 账号插件
 */
class Account {
	
	/**
	 * 获取用户的基本信息
	 */
	getUserInfo() {
		return new Promise(function(resolve, reject) {
			callNative(ACCOUNT_MODULE,'getUserInfo',{},"获取用户信息").then(res => {
				//获取成功，保存一下用户信息
				if(res.isLogin) {
					let userInfo = {
						"userId": res.userInfo.userId,
						"avatar": res.userInfo.avatar,
						"nickname": res.userInfo.nickname
					}
					saveLoginUserInfo(userInfo)
				}
				resolve(res)
			}).catch(error => {
				reject(error)
			})
		})
	}
	
	/**
	 * 拉起登录
	 */
	login() {
		return callNative(ACCOUNT_MODULE,'login',{},"拉起登录框")
	}
}

export default Account;